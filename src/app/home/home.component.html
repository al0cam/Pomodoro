<div class="card-body text-center mb-8">
  <div class="flex justify-center items-center relative mb-6">
    <h1 class="text-4xl md:text-5xl font-extrabold text-white">Pomodoro Pro</h1>
  </div>

  <!-- Mode Selector Buttons -->
  <div class="flex justify-center space-x-3 mb-6">
    <button (click)="switchMode('pomodoro')" class="btn btn-sm sm:btn-md rounded-full font-semibold"
      [ngClass]="{'btn-primary': timerMode() === 'pomodoro', 'btn-ghost text-gray-300': timerMode() !== 'pomodoro'}">
      Pomodoro
    </button>
    <button (click)="switchMode('shortBreak')" class="btn btn-sm sm:btn-md rounded-full font-semibold"
      [ngClass]="{'btn-primary': timerMode() === 'shortBreak', 'btn-ghost text-gray-300': timerMode() !== 'shortBreak'}">
      Short Break
    </button>
    <button (click)="switchMode('longBreak')" class="btn btn-sm sm:btn-md rounded-full font-semibold"
      [ngClass]="{'btn-primary': timerMode() === 'longBreak', 'btn-ghost text-gray-300': timerMode() !== 'longBreak'}">
      Long Break
    </button>
  </div>

  <!-- Timer Display -->
  <div class="text-7xl md:text-8xl font-bold text-primary-focus mb-6 tracking-tight">
    {{ formattedTime() }}
  </div>

  <!-- Timer Control Buttons -->
  <div class="flex justify-center space-x-4">
    <button (click)="toggleTimer()" class="btn btn-lg rounded-full text-white font-bold text-lg shadow-lg"
      [ngClass]="{'btn-error': isActive(), 'btn-success': !isActive()}">
      {{ isActive() ? 'Pause' : 'Start' }}
    </button>
    <button (click)="resetTimer()" class="btn btn-lg rounded-full btn-warning text-white font-bold text-lg shadow-lg">
      Reset
    </button>
  </div>

</div>

<!-- Task List Section -->
<hr class="my-8 border-t-2 border-base-200" />

<h2 class="text-3xl font-bold text-primary mb-6 text-center">Your Tasks</h2>

<!-- Add New Task Button & Form (Conditional based on login and showAddTaskForm) -->
<div *ngIf="authService.isAuthenticated()" class="mb-8">
  <div class="flex justify-center mb-4">
    <button (click)="toggleAddTaskForm()"
      class="btn btn-secondary text-white font-bold py-3 px-6 shadow-md rounded-full">
      {{ showAddTaskForm() ? 'Hide Add Task Form' : 'Add New Task' }}
    </button>
  </div>

  <form *ngIf="showAddTaskForm()" (ngSubmit)="handleAddTask()" class="p-4 bg-base-200 rounded-lg shadow-inner">
    <input type="text" placeholder="Task Title (e.g., Finish report)" [(ngModel)]="newTaskTitle" name="newTaskTitle"
      required
      class="input input-bordered input-primary w-full p-3 mb-3 focus:outline-none focus:ring-2 focus:ring-primary bg-white/10 border-white/30 text-white placeholder-gray-300" />
    <textarea placeholder="Task Description (optional)" [(ngModel)]="newTaskDesc" name="newTaskDesc" rows="2"
      class="textarea textarea-bordered textarea-primary w-full p-3 mb-3 focus:outline-none focus:ring-2 focus:ring-primary resize-y bg-white/10 border-white/30 text-white placeholder-gray-300"></textarea>
    <input type="number" placeholder="Estimated Pomodoros (e.g., 2)" [(ngModel)]="newTaskEstimatedPomodoros"
      name="newTaskEstimatedPomodoros" min="1"
      class="input input-bordered input-primary w-full p-3 mb-4 focus:outline-none focus:ring-2 focus:ring-primary bg-white/10 border-white/30 text-white placeholder-gray-300" />
    <button type="submit" class="btn btn-primary w-full text-white font-bold py-3 px-4 shadow-md">
      Add Task
    </button>
  </form>
</div>

<div *ngIf="!authService.isAuthenticated()" class="alert alert-info text-center mb-8 text-white">
  <svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)" fill="none" viewBox="0 0 24 24"
    class="stroke-current shrink-0 w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
      d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
  </svg>
  <span>Login or Register to create and manage tasks.</span>
</div>


<!-- Task List Display -->
<div class="space-y-4">
  <p *ngIf="sortedTasks().length === 0" class="text-center text-gray-300 text-lg py-8">No tasks yet! Add one above to
    get started.</p>
  <app-task-item *ngFor="let task of sortedTasks(); trackBy: trackById" [task]="task"
    (toggleCompletion)="toggleTaskCompletion($event)" (toggleExpansion)="toggleTaskExpansion($event)"
    (deleteTask)="deleteTask($event)" [allowEditDelete]="authService.isAuthenticated()" />
</div>
